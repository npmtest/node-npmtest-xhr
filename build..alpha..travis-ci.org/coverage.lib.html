<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-xhr/node_modules/xhr/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-xhr">npmtest-xhr (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-xhr/node_modules/xhr/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.42% <small>(22 / 134)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">4.81% <small>(5 / 104)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">17.65% <small>(3 / 17)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">16.79% <small>(22 / 131)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-xhr/node_modules/xhr/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var window = require("global/window")
var isFunction = require("is-function")
var parseHeaders = require("parse-headers")
var xtend = require("xtend")
&nbsp;
module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? <span class="branch-0 cbranch-no" title="branch not covered" >createXHR.XMLHttpRequest </span>: window.XDomainRequest
&nbsp;
forEachArray(["get", "put", "post", "patch", "head", "delete"], function(method) {
    createXHR[method === "delete" ? "del" : method] = <span class="fstat-no" title="function not covered" >function(uri, options, callback) {</span>
<span class="cstat-no" title="statement not covered" >        options = initParams(uri, options, callback)</span>
<span class="cstat-no" title="statement not covered" >        options.method = method.toUpperCase()</span>
<span class="cstat-no" title="statement not covered" >        return _createXHR(options)</span>
    }
})
&nbsp;
function forEachArray(array, iterator) {
    for (var i = 0; i &lt; array.length; i++) {
        iterator(array[i])
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function isEmpty(obj){</span>
<span class="cstat-no" title="statement not covered" >    for(var i in obj){</span>
<span class="cstat-no" title="statement not covered" >        if(obj.hasOwnProperty(i)) <span class="cstat-no" title="statement not covered" >return false</span></span>
    }
<span class="cstat-no" title="statement not covered" >    return true</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function initParams(uri, options, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var params = uri</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (isFunction(options)) {</span>
<span class="cstat-no" title="statement not covered" >        callback = options</span>
<span class="cstat-no" title="statement not covered" >        if (typeof uri === "string") {</span>
<span class="cstat-no" title="statement not covered" >            params = {uri:uri}</span>
        }
    } else {
<span class="cstat-no" title="statement not covered" >        params = xtend(options, {uri: uri})</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    params.callback = callback</span>
<span class="cstat-no" title="statement not covered" >    return params</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function createXHR(uri, options, callback) {</span>
<span class="cstat-no" title="statement not covered" >    options = initParams(uri, options, callback)</span>
<span class="cstat-no" title="statement not covered" >    return _createXHR(options)</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function _createXHR(options) {</span>
<span class="cstat-no" title="statement not covered" >    if(typeof options.callback === "undefined"){</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("callback argument missing")</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var called = false</span>
<span class="cstat-no" title="statement not covered" >    var callback = <span class="fstat-no" title="function not covered" >function cbOnce(err, response, body){</span></span>
<span class="cstat-no" title="statement not covered" >        if(!called){</span>
<span class="cstat-no" title="statement not covered" >            called = true</span>
<span class="cstat-no" title="statement not covered" >            options.callback(err, response, body)</span>
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function readystatechange() {</span>
<span class="cstat-no" title="statement not covered" >        if (xhr.readyState === 4) {</span>
<span class="cstat-no" title="statement not covered" >            setTimeout(loadFunc, 0)</span>
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getBody() {</span>
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
<span class="cstat-no" title="statement not covered" >        var body = undefined</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (xhr.response) {</span>
<span class="cstat-no" title="statement not covered" >            body = xhr.response</span>
        } else {
<span class="cstat-no" title="statement not covered" >            body = xhr.responseText || getXml(xhr)</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (isJson) {</span>
<span class="cstat-no" title="statement not covered" >            try {</span>
<span class="cstat-no" title="statement not covered" >                body = JSON.parse(body)</span>
            } catch (e) {}
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        return body</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function errorFunc(evt) {</span>
<span class="cstat-no" title="statement not covered" >        clearTimeout(timeoutTimer)</span>
<span class="cstat-no" title="statement not covered" >        if(!(evt instanceof Error)){</span>
<span class="cstat-no" title="statement not covered" >            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )</span>
        }
<span class="cstat-no" title="statement not covered" >        evt.statusCode = 0</span>
<span class="cstat-no" title="statement not covered" >        return callback(evt, failureResponse)</span>
    }
&nbsp;
    // will load the data &amp; process the response in a special response object
<span class="fstat-no" title="function not covered" >    function loadFunc() {</span>
<span class="cstat-no" title="statement not covered" >        if (aborted) <span class="cstat-no" title="statement not covered" >return</span></span>
<span class="cstat-no" title="statement not covered" >        var status</span>
<span class="cstat-no" title="statement not covered" >        clearTimeout(timeoutTimer)</span>
<span class="cstat-no" title="statement not covered" >        if(options.useXDR &amp;&amp; xhr.status===undefined) {</span>
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
<span class="cstat-no" title="statement not covered" >            status = 200</span>
        } else {
<span class="cstat-no" title="statement not covered" >            status = (xhr.status === 1223 ? 204 : xhr.status)</span>
        }
<span class="cstat-no" title="statement not covered" >        var response = failureResponse</span>
<span class="cstat-no" title="statement not covered" >        var err = null</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (status !== 0){</span>
<span class="cstat-no" title="statement not covered" >            response = {</span>
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
<span class="cstat-no" title="statement not covered" >            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE</span>
<span class="cstat-no" title="statement not covered" >                response.headers = parseHeaders(xhr.getAllResponseHeaders())</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            err = new Error("Internal XMLHttpRequest Error")</span>
        }
<span class="cstat-no" title="statement not covered" >        return callback(err, response, response.body)</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var xhr = options.xhr || null</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!xhr) {</span>
<span class="cstat-no" title="statement not covered" >        if (options.cors || options.useXDR) {</span>
<span class="cstat-no" title="statement not covered" >            xhr = new createXHR.XDomainRequest()</span>
        }else{
<span class="cstat-no" title="statement not covered" >            xhr = new createXHR.XMLHttpRequest()</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var key</span>
<span class="cstat-no" title="statement not covered" >    var aborted</span>
<span class="cstat-no" title="statement not covered" >    var uri = xhr.url = options.uri || options.url</span>
<span class="cstat-no" title="statement not covered" >    var method = xhr.method = options.method || "GET"</span>
<span class="cstat-no" title="statement not covered" >    var body = options.body || options.data</span>
<span class="cstat-no" title="statement not covered" >    var headers = xhr.headers = options.headers || {}</span>
<span class="cstat-no" title="statement not covered" >    var sync = !!options.sync</span>
<span class="cstat-no" title="statement not covered" >    var isJson = false</span>
<span class="cstat-no" title="statement not covered" >    var timeoutTimer</span>
<span class="cstat-no" title="statement not covered" >    var failureResponse = {</span>
        body: undefined,
        headers: {},
        statusCode: 0,
        method: method,
        url: uri,
        rawRequest: xhr
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if ("json" in options &amp;&amp; options.json !== false) {</span>
<span class="cstat-no" title="statement not covered" >        isJson = true</span>
<span class="cstat-no" title="statement not covered" >        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") </span>//Don't override existing accept header declared by user
<span class="cstat-no" title="statement not covered" >        if (method !== "GET" &amp;&amp; method !== "HEAD") {</span>
<span class="cstat-no" title="statement not covered" >            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") </span>//Don't override existing accept header declared by user
<span class="cstat-no" title="statement not covered" >            body = JSON.stringify(options.json === true ? body : options.json)</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    xhr.onreadystatechange = readystatechange</span>
<span class="cstat-no" title="statement not covered" >    xhr.onload = loadFunc</span>
<span class="cstat-no" title="statement not covered" >    xhr.onerror = errorFunc</span>
    // IE9 must have onprogress be set to a unique function.
<span class="cstat-no" title="statement not covered" >    xhr.onprogress = <span class="fstat-no" title="function not covered" >function () {</span></span>
        // IE must die
    }
<span class="cstat-no" title="statement not covered" >    xhr.onabort = <span class="fstat-no" title="function not covered" >function(){</span></span>
<span class="cstat-no" title="statement not covered" >        aborted = true;</span>
    }
<span class="cstat-no" title="statement not covered" >    xhr.ontimeout = errorFunc</span>
<span class="cstat-no" title="statement not covered" >    xhr.open(method, uri, !sync, options.username, options.password)</span>
    //has to be after open
<span class="cstat-no" title="statement not covered" >    if(!sync) {</span>
<span class="cstat-no" title="statement not covered" >        xhr.withCredentials = !!options.withCredentials</span>
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
<span class="cstat-no" title="statement not covered" >    if (!sync &amp;&amp; options.timeout &gt; 0 ) {</span>
<span class="cstat-no" title="statement not covered" >        timeoutTimer = setTimeout(<span class="fstat-no" title="function not covered" >function(){</span></span>
<span class="cstat-no" title="statement not covered" >            if (aborted) <span class="cstat-no" title="statement not covered" >return</span></span>
<span class="cstat-no" title="statement not covered" >            aborted = true/</span>/IE9 may still call readystatechange
<span class="cstat-no" title="statement not covered" >            xhr.abort("timeout")</span>
<span class="cstat-no" title="statement not covered" >            var e = new Error("XMLHttpRequest timeout")</span>
<span class="cstat-no" title="statement not covered" >            e.code = "ETIMEDOUT"</span>
<span class="cstat-no" title="statement not covered" >            errorFunc(e)</span>
        }, options.timeout )
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (xhr.setRequestHeader) {</span>
<span class="cstat-no" title="statement not covered" >        for(key in headers){</span>
<span class="cstat-no" title="statement not covered" >            if(headers.hasOwnProperty(key)){</span>
<span class="cstat-no" title="statement not covered" >                xhr.setRequestHeader(key, headers[key])</span>
            }
        }
    } else <span class="cstat-no" title="statement not covered" >if (options.headers &amp;&amp; !isEmpty(options.headers)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Headers cannot be set on an XDomainRequest object")</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if ("responseType" in options) {</span>
<span class="cstat-no" title="statement not covered" >        xhr.responseType = options.responseType</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if ("beforeSend" in options &amp;&amp;</span>
        typeof options.beforeSend === "function"
    ) {
<span class="cstat-no" title="statement not covered" >        options.beforeSend(xhr)</span>
    }
&nbsp;
    // Microsoft Edge browser sends "undefined" when send is called with undefined value.
    // XMLHttpRequest spec says to pass null as body to indicate no body
    // See https://github.com/naugtur/xhr/issues/100.
<span class="cstat-no" title="statement not covered" >    xhr.send(body || null)</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return xhr</span>
&nbsp;
&nbsp;
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getXml(xhr) {</span>
<span class="cstat-no" title="statement not covered" >    if (xhr.responseType === "document") {</span>
<span class="cstat-no" title="statement not covered" >        return xhr.responseXML</span>
    }
<span class="cstat-no" title="statement not covered" >    var firefoxBugTakenEffect = xhr.responseXML &amp;&amp; xhr.responseXML.documentElement.nodeName === "parsererror"</span>
<span class="cstat-no" title="statement not covered" >    if (xhr.responseType === "" &amp;&amp; !firefoxBugTakenEffect) {</span>
<span class="cstat-no" title="statement not covered" >        return xhr.responseXML</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return null</span>
}
&nbsp;
function noop() {}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 18 2017 21:36:22 GMT+0000 (UTC)</div>
</div>
</body>
</html>
